<!DOCTYPE html>
<html lang="ko">
<head>
    <title>Vue3 + PrimeVue Sample</title>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=0.9, maximum-scale=1.8, minimum-scale=0.9, user-scalable=yes">

    <script>
        (function () {
            // ìˆ¨ê¸¸ ë©”ì‹œì§€ íŒ¨í„´(ë¶€ë¶„ ì¼ì¹˜)
            const dropPhrases = [
                'You are running a development build of Vue',
                'The browser build of Tailwind CSS should not be used in production'
            ];

            const keep = {
                log: console.log.bind(console),
                info: console.info.bind(console),
                warn: console.warn.bind(console),
                error: console.error.bind(console),
                debug: console.debug.bind(console),
            };

            const shouldDrop = (args) => {
                try {
                    const text = args.map(a => String(a)).join(' ');
                    return dropPhrases.some(p => text.includes(p));
                } catch (_) {
                    return false;
                }
            };

            console.info = (...args) => { if (!shouldDrop(args)) keep.info(...args); };
            console.warn = (...args) => { if (!shouldDrop(args)) keep.warn(...args); };
            // í•„ìš”ì‹œ ì•„ë˜ë„ í™œì„±í™”
            // console.log  = (...args) => { if (!shouldDrop(args)) keep.log(...args); };
            // console.debug= (...args) => { if (!shouldDrop(args)) keep.debug(...args); };
        })();
    </script>

    <link href="css/primeicons.css" rel="stylesheet"/>
    <link href="/css/swiper-bundle.min.css" rel="stylesheet"/>
    <link href="css/custom.css" rel="stylesheet"/>
    <link href="css/overlayscrollbars.min.css" rel="stylesheet"/>

    <script src="js/vue.global.js"></script>
    <script src="js/primevue.min.js"></script>
    <script src="js/aura.js"></script>
    <script src="js/tailwindcss.js"></script>
    <script src="/js/swiper-bundle.min.js"></script>
    <script src="/js/overlayscrollbars.browser.es6.min.js"></script>

</head>
<body class="bg-gray-100">
<div id="app">
    <overlay-scrollbars style="max-height: 100vh;">
        <div class="mx-auto p-6 space-y-6" style="max-width: 1035px;">
            <h1 class="text-2xl font-bold text-center">Vue3 + PrimeVue Sample <span class="text-cyan-600">(Form)</span></h1>

            <p-toolbar class="justify-between">
                <template #center>
                    <div class="flex flex-wrap gap-2">
                        <a href="sample1.html">
                            <p-button label="Form" size="small" variant="text" severity="primary"/>
                        </a>
                        <a href="sample2.html">
                            <p-button label="Tabs/Swiper/Drawer" size="small" variant="text" severity="secondary"/>
                        </a>
                        <a href="sample8.html">
                            <p-button label="Accordian" size="small" variant="text" severity="success"/>
                        </a>
                        <a href="sample3.html">
                            <p-button label="DataTable" size="small" variant="text" severity="info"/>
                        </a>
                        <a href="sample7.html">
                            <p-button label="Overlays" size="small" variant="text" severity="warn"/>
                        </a>
                        <a href="sample5.html">
                            <p-button label="Button" size="small" variant="text" severity="help"/>
                        </a>
                        <a href="sample4.html">
                            <p-button label="Tree/PickList" size="small" variant="text" severity="danger"/>
                        </a>
                        <a href="sample6.html">
                            <p-button label="Tag/Spinner/Toast" size="small" variant="text" severity="contrast"/>
                        </a>
                    </div>
                </template>
            </p-toolbar>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">InputText</h2>
                <p-input-text
                        v-model="name"
                        placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                        class="w-full"
                ></p-input-text>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ name }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ name }}</code></p>

                <div class="mt-4">
                    <h3 class="text-sm font-medium mb-2">InputText + ë‹ë³´ê¸° ì•„ì´ì½˜ (ì˜¤ë¥¸ìª½, IconField ì‚¬ìš©)</h3>
                    <p-icon-field icon-position="right" class="w-full" @click="onSearch">
                        <p-input-text
                                v-model="searchText"
                                class="w-full"
                                readonly
                        ></p-input-text>
                        <p-input-icon class="pi pi-search cursor-pointer"></p-input-icon>
                    </p-icon-field>
                    <p class="text-xs text-gray-600 mt-1">í‘œì‹œê°’: <code>{{ searchText }}</code></p>
                    <p class="text-xs text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ searchText }}</code></p>
                </div>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">InputMask</h2>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm mb-1">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</label>
                        <p-input-mask
                                v-model="mask.ssn"
                                mask="999999-9999999"
                                placeholder="######-#######"
                                class="w-full"
                        ></p-input-mask>
                        <p class="text-xs text-gray-600">í‘œì‹œê°’: <code>{{ mask.ssn }}</code></p>
                        <p class="text-xs text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ mask.ssn }}</code></p>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</label>
                        <p-input-mask
                                v-model="mask.biz"
                                mask="999-99-99999"
                                placeholder="###-##-#####"
                                class="w-full"
                        ></p-input-mask>
                        <p class="text-xs text-gray-600">í‘œì‹œê°’: <code>{{ mask.biz }}</code></p>
                        <p class="text-xs text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ mask.biz }}</code></p>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">íœ´ëŒ€í°ë²ˆí˜¸</label>
                        <p-input-mask
                                v-model="mask.mobile"
                                :mask="mobileMask"
                                placeholder="010-1234-5678"
                                class="w-full"
                        ></p-input-mask>
                        <p class="text-xs text-gray-600">í‘œì‹œê°’: <code>{{ mask.mobile }}</code></p>
                        <p class="text-xs text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ mask.mobile }}</code></p>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">ì „í™”ë²ˆí˜¸(ì§€ì—­ë²ˆí˜¸)</label>
                        <p-input-mask
                                v-model="mask.tel"
                                :mask="telMask"
                                placeholder="02-123-4567 ë˜ëŠ” 031-123-4567"
                                class="w-full"
                        ></p-input-mask>
                        <p class="text-xs text-gray-600">í‘œì‹œê°’: <code>{{ mask.tel }}</code></p>
                        <p class="text-xs text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ mask.tel }}</code></p>
                    </div>
                </div>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">InputNumber (ì˜¤ì§ ìˆ«ìë§Œ, ìµœì†Ÿ/ìµœëŒ“ê°’ ìˆìŒ)</h2>
                <p-input-number
                        v-model="amount"
                        :min="0"
                        :max="100"
                        class="w-full"
                ></p-input-number>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ amount }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ typeof amount === 'number' ? amount : Number(amount) }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">Textarea</h2>
                <p-textarea
                        v-model="bio"
                        :auto-resize="true"
                        :rows="3"
                        placeholder="ìê¸°ì†Œê°œë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                        class="w-full"
                ></p-textarea>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ bio }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ bio }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">Password</h2>
                <p-password
                        v-model="password"
                        :toggle-mask="true"
                        :feedback="false"
                        placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                        class="w-full"
                ></p-password>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ password }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ password }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">Select</h2>
                <p-select
                        v-model="country"
                        :options="countryOptions"
                        option-label="label"
                        option-value="value"
                        placeholder="êµ­ê°€ ì„ íƒ"
                        show-clear
                        filter
                        class="w-full"
                ></p-select>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ countryLabel }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ country }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">MultiSelect</h2>
                <p-multi-select
                        v-model="cities"
                        :options="cityOptions"
                        option-label="label"
                        option-value="value"
                        display="chip"
                        placeholder="ë„ì‹œ ì„ íƒ"
                        show-clear
                        filter
                        class="w-full"
                >
                </p-multi-select>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ cityLabels }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ JSON.stringify(cities) }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">TreeSelect</h2>
                <p-tree-select
                        v-model="treeValue"
                        :options="treeOptions"
                        placeholder="ë…¸ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”"
                        show-clear
                        class="w-full"
                ></p-tree-select>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ treeLabels }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ JSON.stringify(treeValue) }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">DatePicker</h2>
                <p-date-picker
                        v-model="date"
                        :min-date="minDate"
                        :max-date="maxDate"
                        :locale="{ rangeSeparator: ' ~ ' }"
                ></p-date-picker>
                <p class="text-xs text-gray-500 mt-1">í—ˆìš© ë²”ìœ„: <code>{{ minDate ? formattedBound(minDate) : '-' }}</code> ~ <code>{{ maxDate ? formattedBound(maxDate) : '-' }}</code></p>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ formattedDate }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ rawDateValue }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">DatePicker (Range)</h2>
                <p-range-picker
                        v-model="dateRange"
                        :min-date="minDate"
                        :max-date="maxDate"
                        :locale="{ rangeSeparator: ' ~ ' }"
                ></p-range-picker>
                <p class="text-xs text-gray-500 mt-1">í—ˆìš© ë²”ìœ„: <code>{{ minDate ? formattedBound(minDate) : '-' }}</code> ~ <code>{{ maxDate ? formattedBound(maxDate) : '-' }}</code></p>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ formattedDateRange }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ rawDateRangeValue }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">Checkbox</h2>
                <div class="flex items-center gap-2">
                    <p-checkbox
                            v-model="agreements"
                            input-id="agree1"
                            value="agree"
                            binary
                    ></p-checkbox>
                    <label class="cursor-default">ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤</label>
                </div>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ agreements ? 'ë™ì˜' : 'ë¯¸ë™ì˜' }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ agreements }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">RadioButton</h2>
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2">
                        <p-radio-button
                                v-model="gender"
                                value="M"
                        ></p-radio-button>
                        <span>ë‚¨</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <p-radio-button
                                v-model="gender"
                                value="F"
                        ></p-radio-button>
                        <span>ì—¬</span>
                    </div>
                </div>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ genderLabel }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ gender }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">ToggleButton</h2>
                <p-toggle-button
                        v-model="subscribed"
                        on-label="ON"
                        off-label="OFF"
                ></p-toggle-button>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ subscribed ? 'ON' : 'OFF' }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ subscribed }}</code></p>
            </section>

            <section class="bg-white p-4 rounded shadow">
                <h2 class="text-lg font-semibold mb-2">ToggleSwitch</h2>
                <p-toggle-switch
                        v-model="notifyEnabled"
                        true-value="on"
                        false-value="off"
                ></p-toggle-switch>
                <p class="text-sm text-gray-600">í‘œì‹œê°’: <code>{{ notifyEnabled === 'on' ? 'ON' : 'OFF' }}</code></p>
                <p class="text-sm text-gray-600">ì‹¤ì œ ìƒíƒœê°’: <code>{{ notifyEnabled }}</code></p>
            </section>
        </div>
    </overlay-scrollbars>
</div>

<script>
    const {createApp, ref, computed, reactive, h, mergeProps, nextTick} = Vue;

    const app = createApp({
        setup() {
            // ê°œë³„ ìƒíƒœ
            const name = ref('');
            const bio = ref('');
            const password = ref('');
            const country = ref(null);
            const cities = ref([]);
            const date = ref(null);
            const dateRange = ref(null);
            const agreements = ref(false); // binary ì²´í¬ë°•ìŠ¤ëŠ” boolean
            const gender = ref('M');
            const amount = ref(1);
            const subscribed = ref(true);
            const notifyEnabled = ref('off');
            const treeValue = ref(null);

            // ê²€ìƒ‰ ì¸í’‹ ìƒíƒœ
            const searchText = ref('');

            // InputMask ìƒíƒœ
            const mask = reactive({ssn: '', biz: '', mobile: '', tel: ''});
            // ë§ˆìŠ¤í¬ íŒ¨í„´
            const mobileMask = computed(() => '999-9999-9999');
            const telMask = computed(() => (mask.tel && mask.tel.startsWith('02') ? '99-999-9999' : '999-999-9999'));

            // DatePicker ê²½ê³„ê°’ (ì˜¤ëŠ˜ ê¸°ì¤€ -30ì¼ ~ +30ì¼)
            const today = new Date();
            const minDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 30);
            const maxDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 30);

            // ì˜µì…˜ ë°ì´í„°
            const countryOptions = [
                {label: 'í•œêµ­', value: 'KR'},
                {label: 'ë¯¸êµ­', value: 'US'}
            ];
            const cityOptions = [
                {label: 'ì„œìš¸', value: 'SEL'},
                {label: 'ë¶€ì‚°', value: 'BSN'}
            ];

            // TreeSelect ì˜µì…˜ (ê°„ë‹¨ ìƒ˜í”Œ)
            const treeOptions = [
                {
                    key: 'A',
                    label: 'A ê·¸ë£¹',
                    children: [
                        {key: 'A-1', label: 'A-1 í•­ëª©'},
                        {key: 'A-2', label: 'A-2 í•­ëª©'}
                    ]
                },
                {
                    key: 'B',
                    label: 'B ê·¸ë£¹',
                    children: [
                        {key: 'B-1', label: 'B-1 í•­ëª©'},
                        {key: 'B-2', label: 'B-2 í•­ëª©'}
                    ]
                }
            ];

            // í‘œì‹œê°’ ê³„ì‚°
            const countryLabel = computed(() => {
                const found = countryOptions.find(o => o.value === country.value);
                return found ? found.label : '';
            });
            const cityLabels = computed(() => {
                if (!Array.isArray(cities.value)) return '';
                return cities.value
                    .map(v => (cityOptions.find(o => o.value === v)?.label) || v)
                    .join(', ');
            });
            const genderLabel = computed(() => (gender.value === 'M' ? 'ë‚¨' : gender.value === 'F' ? 'ì—¬' : ''));
            const treeLabels = computed(() => {
                if (!treeValue.value) return '';
                const keys = Array.isArray(treeValue.value) ? treeValue.value : [treeValue.value];
                const findLabel = (nodes, key) => {
                    for (const n of nodes) {
                        if (n.key === key) return n.label;
                        if (n.children) {
                            const r = findLabel(n.children, key);
                            if (r) return r;
                        }
                    }
                    return key;
                };
                return keys.map(k => findLabel(treeOptions, k)).join(', ');
            });
            // dayjs ê¸°ë°˜ ë‚ ì§œ í‘œì‹œê°’
            // dayjs ì•ˆì „ ì ‘ê·¼ì (UMD/various builds ëŒ€ì‘)
            const resolveDayjs = () => {
                const g = window;
                if (g && typeof g.dayjs === 'function') return g.dayjs;
                if (g && g.dayjs && typeof g.dayjs.default === 'function') return g.dayjs.default;
                return null;
            };

            // dayjs ê¸°ë°˜ ë‚ ì§œ í‘œì‹œê°’ (fallback í¬í•¨)
            const formattedDate = computed(() => {
                if (!date.value) return '';
                const dj = resolveDayjs();
                console.log('formattedDate: dj', dj);
                if (dj) {
                    const d = dj(date.value);
                    return d.isValid() ? d.format('YYYY-MM-DD') : String(date.value);
                }
                // fallback: native Date
                const nd = date.value instanceof Date ? date.value : new Date(date.value);
                if (Number.isNaN(nd.getTime())) return String(date.value);
                const yyyy = nd.getFullYear();
                const mm = String(nd.getMonth() + 1).padStart(2, '0');
                const dd = String(nd.getDate()).padStart(2, '0');
                return `${yyyy}-${mm}-${dd}`;
            });

            // ì‹¤ì œ ìƒíƒœê°’(yyyymmdd) í‘œí˜„ìš© ê³„ì‚°ê°’
            const rawDateValue = computed(() => {
                if (!date.value) return '';
                const dj = resolveDayjs();
                if (dj) {
                    const d = dj(date.value);
                    return d.isValid() ? d.format('YYYYMMDD') : '';
                }
                // fallback: native Date
                const nd = date.value instanceof Date ? date.value : new Date(date.value);
                if (Number.isNaN(nd.getTime())) return '';
                const yyyy = nd.getFullYear();
                const mm = String(nd.getMonth() + 1).padStart(2, '0');
                const dd = String(nd.getDate()).padStart(2, '0');
                return `${yyyy}${mm}${dd}`;
            });

            // Range í‘œì‹œê°’ ë° ì‹¤ì œê°’ ê³„ì‚°
            const formattedDateRange = computed(() => {
                const r = dateRange.value;
                if (!Array.isArray(r) || r.length < 2 || !r[0] || !r[1]) return '';
                const dj = resolveDayjs();
                const fmt = (v) => {
                    if (dj) {
                        const d = dj(v);
                        return d.isValid() ? d.format('YYYY-MM-DD') : '';
                    }
                    const nd = v instanceof Date ? v : new Date(v);
                    if (Number.isNaN(nd.getTime())) return '';
                    const yyyy = nd.getFullYear();
                    const mm = String(nd.getMonth() + 1).padStart(2, '0');
                    const dd = String(nd.getDate()).padStart(2, '0');
                    return `${yyyy}-${mm}-${dd}`;
                };
                const a = fmt(r[0]);
                const b = fmt(r[1]);
                return a && b ? `${a} ~ ${b}` : '';
            });
            const rawDateRangeValue = computed(() => {
                const r = dateRange.value;
                if (!Array.isArray(r) || r.length < 2 || !r[0] || !r[1]) return '';
                const dj = resolveDayjs();
                const fmt = (v) => {
                    if (dj) {
                        const d = dj(v);
                        return d.isValid() ? d.format('YYYYMMDD') : '';
                    }
                    const nd = v instanceof Date ? v : new Date(v);
                    if (Number.isNaN(nd.getTime())) return '';
                    const yyyy = nd.getFullYear();
                    const mm = String(nd.getMonth() + 1).padStart(2, '0');
                    const dd = String(nd.getDate()).padStart(2, '0');
                    return `${yyyy}${mm}${dd}`;
                };
                const a = fmt(r[0]);
                const b = fmt(r[1]);
                return a && b ? `${a},${b}` : '';
            });

            return {
                // state
                name, bio, password, country, cities, date, dateRange, agreements, gender, amount, subscribed,
                countryOptions, cityOptions, treeOptions,
                // í‘œì‹œê°’ helpers
                countryLabel, cityLabels, genderLabel, treeLabels, formattedDate, rawDateValue,
                // range helpers
                formattedDateRange, rawDateRangeValue,
                // input mask
                mask, mobileMask, telMask,
                // datepicker bounds
                minDate, maxDate,
                // search input
                searchText,
                // toggle-switch & tree-select state
                notifyEnabled, treeValue,
                // helper to format bounds
                formattedBound: (d) => {
                    const yyyy = d.getFullYear();
                    const mm = String(d.getMonth() + 1).padStart(2, '0');
                    const dd = String(d.getDate()).padStart(2, '0');
                    return `${yyyy}-${mm}-${dd}`;
                },
            };
        },
        methods: {
            onSearch() {
                // ë°ëª¨ìš©: ê²€ìƒ‰ì–´ë¥¼ ì½˜ì†”ì— ì¶œë ¥
                console.log('ê²€ìƒ‰:', this.searchText);
                alert(`ê²€ìƒ‰: ${this.searchText || ''}`);
            }
        }
    });

    // PrimeVue ì„¤ì • ë° ì»´í¬ë„ŒíŠ¸ ë“±ë¡
    app.use(PrimeVue.Config, {
        theme: {
            preset: PrimeUIX.Themes.Aura
        },
        // PrimeVue v4+/v5 expects locale keys at the root, not nested under date
        locale: {
            firstDayOfWeek: 0,
            weekHeader: 'ì£¼',
            dayNames: ["ì¼ìš”ì¼", "ì›”ìš”ì¼", "í™”ìš”ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼", "ê¸ˆìš”ì¼", "í† ìš”ì¼"],
            dayNamesShort: ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
            dayNamesMin: ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
            monthNames: ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”", "7ì›”", "8ì›”", "9ì›”", "10ì›”", "11ì›”", "12ì›”"],
            monthNamesShort: ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”", "7ì›”", "8ì›”", "9ì›”", "10ì›”", "11ì›”", "12ì›”"],
            today: 'ì˜¤ëŠ˜',
            clear: 'ì§€ìš°ê¸°',
            rangeSeparator: ' ~ ',
            multipleSeparator: ', '
        }
    });

    const {InputText, Textarea, Password, Select, MultiSelect, DatePicker, Checkbox, RadioButton, InputNumber, ToggleButton, InputMask, IconField, InputIcon, ToggleSwitch, TreeSelect, Toolbar, Button} = PrimeVue;

    app.component('p-input-text', InputText);
    app.component('p-textarea', Textarea);
    app.component('p-password', Password);
    app.component('p-select', Select);
    // app.component('p-date-picker', DatePicker);
    app.component('p-multi-select', MultiSelect);
    app.component('p-checkbox', Checkbox);
    app.component('p-radio-button', RadioButton);
    app.component('p-input-number', InputNumber);
    app.component('p-toggle-button', ToggleButton);
    app.component('p-toggle-switch', ToggleSwitch);
    app.component('p-tree-select', TreeSelect);
    app.component('p-input-mask', InputMask);
    app.component('p-icon-field', IconField);
    app.component('p-input-icon', InputIcon);
    app.component('p-toolbar', Toolbar);
    app.component('p-button', Button);

    const baseDefaults = Object.freeze({
        dateFormat: 'yy-mm-dd',
        buttonBar: 'custom',   // 'default' | 'custom' | 'none'
        showIcon: true,
        iconDisplay: 'input',
        manualInput: false,
        fluid: true,
        closeOnClear: true,    // Clear ì‹œ íŒ¨ë„ ë‹«ê¸°
        closeOnToday: true,    // Today ì‹œ íŒ¨ë„ ë‹«ê¸°
        showClear: true,       // ì…ë ¥ë€ ìš°ì¸¡ X ì•„ì´ì½˜ (Selectì™€ ë™ì¼ ì˜µì…˜ëª…)
        clearIconClass: 'pi pi-times' // í•„ìš”ì‹œ ì‚¬ìš©ì ë³€ê²½ ê°€ëŠ¥
    });

    const todayDate = () => {
        const t = new Date();
        return new Date(t.getFullYear(), t.getMonth(), t.getDate());
    };

    // ì˜¤ë²„ë ˆì´ ì°¾ê¸°(ë³´ì´ëŠ” DatePicker)
    function findOpenDatepickerOverlay(root = document) {
        return (
            root.querySelector('.p-datepicker[aria-hidden="false"]') ||
            root.querySelector('.p-datepicker:not([aria-hidden="true"])')
        );
    }

    // íŒ¨ë„ ë‹«ê¸° (official â†’ private â†’ blur â†’ ESC â†’ outside click)
    async function closePanelSafely(dpRef) {
        await nextTick();
        const inst = dpRef?.value;

        try { if (inst?.hide) { inst.hide(); return; } } catch (_) {}
        try { if (inst?.overlayRef?.hide) { inst.overlayRef.hide(); return; } } catch (_) {}

        try {
            const inputEl = inst?.$el?.querySelector?.('input') || document.activeElement;
            inputEl?.blur?.();
            await nextTick();
        } catch (_) {}

        try {
            const target = findOpenDatepickerOverlay(inst?.$el?.ownerDocument || document) || document;
            const escDown = new KeyboardEvent('keydown', { key: 'Escape', code: 'Escape', which: 27, keyCode: 27, bubbles: true });
            const escUp   = new KeyboardEvent('keyup',   { key: 'Escape', code: 'Escape', which: 27, keyCode: 27, bubbles: true });
            target.dispatchEvent(escDown);
            target.dispatchEvent(escUp);
            await nextTick();
        } catch (_) {}

        try {
            ['pointerdown', 'mousedown', 'mouseup', 'click'].forEach(type =>
                document.dispatchEvent(new MouseEvent(type, { bubbles: true }))
            );
        } catch (_) {}
    }

    // PrimeVue ê¸°ë³¸ ë²„íŠ¼ë°”ì™€ ë™ì¼í•œ ë§ˆí¬ì—… í´ë˜ìŠ¤ ì‚¬ìš©
    function buildButtonBar(type, emit, dpRef, opts) {
        const btnCls = 'p-button p-component p-button-secondary p-button-text p-button-sm';
        return h('div', { class: 'p-datepicker-buttonbar', 'data-pc-section': 'buttonbar' }, [
            h('button', {
                type: 'button', class: btnCls, 'aria-label': 'ì˜¤ëŠ˜',
                onClick: async () => {
                    if (type === 'single') emit('update:modelValue', todayDate());
                    else { const t = todayDate(); emit('update:modelValue', [t, t]); }
                    if (opts.closeOnToday) await closePanelSafely(dpRef);
                }
            }, [ h('span', { class: 'p-button-label', 'data-pc-section': 'label' }, 'ì˜¤ëŠ˜') ]),
            h('button', {
                type: 'button', class: btnCls, 'aria-label': 'ì§€ìš°ê¸°',
                onClick: async () => {
                    emit('update:modelValue', null);
                    if (opts.closeOnClear) await closePanelSafely(dpRef);
                }
            }, [ h('span', { class: 'p-button-label', 'data-pc-section': 'label' }, 'ì§€ìš°ê¸°') ]),
        ]);
    }

    // ê³µí†µ: input ì•„ì´ì½˜ ìŠ¬ë¡¯ ìƒì„± (Selectì˜ showClear UXì™€ ë™ì¼)
    function makeInputIconSlot(kind, props, emit, dpRef) {
        const hasValue = () => {
            if (kind === 'single') return props.modelValue instanceof Date;
            return Array.isArray(props.modelValue)
                && props.modelValue[0] instanceof Date
                && props.modelValue[1] instanceof Date;
        };

        const clearHandler = async () => {
            emit('update:modelValue', null);
            if (props.closeOnClear) await closePanelSafely(dpRef);
        };

        const openHandler = (ctx) => ctx?.clickCallback?.();

        return (ctx) => {
            // X (Selectì˜ clear UIì™€ ìœ ì‚¬í•œ í´ë˜ìŠ¤)
            const clearIconEl = Vue.h('i', {
                class: `p-select-clear-icon ${props.clearIconClass || 'pi pi-times'} cursor-pointer`,
                role: 'button',
                tabindex: 0,
                style: { marginRight: '-10px' },
                'aria-label': 'ì§€ìš°ê¸°',
                onClick: clearHandler,
                onKeydown: (e) => {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); clearHandler(); }
                }
            });

            // ğŸ“…
            const calendarIconEl = Vue.h('i', {
                class: 'pi pi-calendar cursor-pointer',
                role: 'button',
                tabindex: 0,
                'aria-label': 'ë‹¬ë ¥ ì—´ê¸°',
                onClick: () => openHandler(ctx),
                onKeydown: (e) => {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openHandler(ctx); }
                }
            });

            // ìˆœì„œ: X â†’ ğŸ“… (Xê°€ ë‹¬ë ¥ ì•„ì´ì½˜ì˜ "ì™¼ìª½"ì— ì˜¤ë„ë¡)
            if (props.showClear !== false && hasValue()) {
                return [clearIconEl, calendarIconEl];
            }
            return [calendarIconEl];
        };
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ p-date-picker (single)
    const PDatePicker = {
        name: 'p-date-picker',
        inheritAttrs: false,
        props: {
            modelValue: { type: [Date, String, Number, null], default: null },
            minDate: { type: Date, default: null },
            maxDate: { type: Date, default: null },
            disabled: { type: Boolean, default: false },
            placeholder: { type: String, default: '' },

            // ê³µí†µ ê¸°ë³¸ê°’/ì˜µì…˜
            dateFormat: { type: String, default: baseDefaults.dateFormat },
            buttonBar:  { type: String, default: baseDefaults.buttonBar }, // 'default' | 'custom' | 'none'
            showIcon:   { type: Boolean, default: baseDefaults.showIcon },
            iconDisplay:{ type: String, default: baseDefaults.iconDisplay },
            manualInput:{ type: Boolean, default: baseDefaults.manualInput },
            fluid:      { type: Boolean, default: baseDefaults.fluid },

            // clear ê´€ë ¨ (Selectì™€ ë™ì¼ ì˜µì…˜ëª…: showClear)
            showClear:     { type: Boolean, default: baseDefaults.showClear },
            clearIconClass:{ type: String,  default: baseDefaults.clearIconClass },

            // íŒ¨ë„ ë‹«ê¸° ì •ì±…
            closeOnClear: { type: Boolean, default: baseDefaults.closeOnClear },
            closeOnToday: { type: Boolean, default: baseDefaults.closeOnToday },
        },
        emits: ['update:modelValue'],
        setup(props, { attrs, slots, emit }) {
            const dpRef = Vue.ref(null);

            const footer = slots.footer || (() =>
                    props.buttonBar === 'custom' ? buildButtonBar('single', emit, dpRef, props) : undefined
            );

            const inputicon = slots.inputicon || makeInputIconSlot('single', props, emit, dpRef);

            return () =>
                Vue.h(
                    PrimeVue.DatePicker,
                    Vue.mergeProps(
                        {
                            ref: dpRef,
                            modelValue: props.modelValue ?? null,
                            'onUpdate:modelValue': v => emit('update:modelValue', v ?? null),

                            dateFormat: props.dateFormat,
                            showButtonBar: props.buttonBar === 'default',
                            showIcon: props.showIcon,
                            iconDisplay: props.iconDisplay,
                            manualInput: props.manualInput,
                            fluid: props.fluid,

                            // â¬‡â¬‡ ì—¬ê¸° ì¶”ê°€: ì•„ì´ì½˜ ê°œìˆ˜ì— ë§ì¶˜ ì˜¤ë¥¸ìª½ íŒ¨ë”©
                            inputStyle: {
                                ...(attrs?.inputStyle || {}),
                                paddingRight: props.iconDisplay === 'input' ? '3.5rem' : '2.25rem'
                            },

                            minDate: props.minDate || null,
                            maxDate: props.maxDate || null,
                            disabled: props.disabled,
                            placeholder: props.placeholder,
                        },
                        attrs
                    ),
                    {
                        ...(footer ? { footer } : {}),
                        inputicon,
                        ...(slots.default ? { default: slots.default } : {}),
                    }
                );
        },
    };

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ p-range-picker (range)
    const PRangePicker = {
        name: 'p-range-picker',
        inheritAttrs: false,
        props: {
            modelValue: { type: [Array, null], default: null }, // [Date, Date] | null
            minDate: { type: Date, default: null },
            maxDate: { type: Date, default: null },
            disabled: { type: Boolean, default: false },
            placeholder: { type: String, default: '' },

            dateFormat:  { type: String, default: baseDefaults.dateFormat },
            buttonBar:   { type: String, default: baseDefaults.buttonBar },
            showIcon:    { type: Boolean, default: baseDefaults.showIcon },
            iconDisplay: { type: String, default: baseDefaults.iconDisplay },
            manualInput: { type: Boolean, default: baseDefaults.manualInput },
            fluid:       { type: Boolean, default: baseDefaults.fluid },

            showClear:      { type: Boolean, default: baseDefaults.showClear },
            clearIconClass: { type: String,  default: baseDefaults.clearIconClass },

            closeOnClear: { type: Boolean, default: baseDefaults.closeOnClear },
            closeOnToday: { type: Boolean, default: baseDefaults.closeOnToday },
        },
        emits: ['update:modelValue'],
        setup(props, { attrs, slots, emit }) {
            const dpRef = Vue.ref(null);

            const footer = slots.footer || (() =>
                    props.buttonBar === 'custom' ? buildButtonBar('range', emit, dpRef, props) : undefined
            );

            const inputicon = slots.inputicon || makeInputIconSlot('range', props, emit, dpRef);

            return () =>
                Vue.h(
                    PrimeVue.DatePicker,
                    Vue.mergeProps(
                        {
                            ref: dpRef,
                            selectionMode: 'range',
                            modelValue: props.modelValue ?? null,
                            'onUpdate:modelValue': v => {
                                const ok = Array.isArray(v) && v[0] instanceof Date && v[1] instanceof Date;
                                emit('update:modelValue', ok ? v : null);
                            },

                            dateFormat: props.dateFormat,
                            showButtonBar: props.buttonBar === 'default',
                            showIcon: props.showIcon,
                            iconDisplay: props.iconDisplay,
                            manualInput: props.manualInput,
                            fluid: props.fluid,

                            // â¬‡â¬‡ ì˜¤ë¥¸ìª½ íŒ¨ë”© ë™ì 
                            inputStyle: {
                                ...(attrs?.inputStyle || {}),
                                paddingRight: props.iconDisplay === 'input' ? '3.5rem' : '2.25rem'
                            },

                            minDate: props.minDate || null,
                            maxDate: props.maxDate || null,
                            disabled: props.disabled,
                            placeholder: props.placeholder,
                        },
                        attrs
                    ),
                    {
                        ...(footer ? { footer } : {}),
                        inputicon,
                        ...(slots.default ? { default: slots.default } : {}),
                    }
                );
        },
    };

    app.component('p-date-picker', PDatePicker)
    app.component('p-range-picker', PRangePicker)

    app.component('overlay-scrollbars', {
        props: ['style', 'class'],
        mounted() {
            window.OverlayScrollbarsGlobal.OverlayScrollbars(this.$el, {scrollbars: {autoHide: 'scroll'}});
        },
        render() {
            return Vue.h('div', {style: this.style, class: this.class}, this.$slots.default());
        }
    });

    app.mount('#app');
</script>
</body>
</html>
